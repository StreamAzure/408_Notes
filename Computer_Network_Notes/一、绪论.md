# 一、绪论

## 1.1 基本概念

> 分组交换

（1）发送方将较长的报文划分为若干个等长的数据段，在数据段前面加上必要的控制信息（报文）构成**分组**，进行传输。由接收方重组。

（2）存储转发，每个分组独立地选择最合适的转发路由，体现**灵活性**。

（3）存储转发，分组传输过程中动态分配传输带宽，断续地逐段占用通信资源，体现**高效性**。

（4）以分组作为传输单位，主机之间不需要预先建立连接即可发送分组，体现**迅速**性。

（5）采用可靠的网络协议，分布式多路由的分组交换网，使网络有很好的生存性（不至于因为网络拥塞或少数节点、链路损坏而导致整体瘫痪），体现**可靠性**。

> 协议

规定数据交换格式及相关同步问题。

协议三要素：

（1）语法：数据与控制信息的结构与格式（怎么说）

（2）语义：发出何种控制信息，完成何种动作，作出何种响应（说什么）

（3）同步：事件实现顺序的详细说明（何时说）

形式：

（1）人来阅读与理解的文字描述

（2）计算机能理解的程序代码

> 服务

在计算机网络体系结构中，下层为相邻的上层提供的功能调用。

> 协议与服务的区别与联系

（1）协议是“水平”的，是控制对等实体之间通信的规则；服务是“垂直”的，是下层向上层通过层间接口（**服务访问点，Service Access Point，SAP**，是*抽象的逻辑接口*）提供的

（2）层与层之间交换的数据单位为服务数据单元（Service Data Unit，SDU），对等层次之间传送的数据单位为协议数据单元（Protocol Data Unit，PDU）

（3）本层协议的实现保证了能够向上一层提供服务，而实现本层协议又需要使用下一层所提供的服务。本层只能看见所提供的服务，而看不见下一层所使用的协议；服务也仅限于本层所看到的部分，不一定是下一层所完成的全部功能。

## 1.2 网络性能衡量指标

> 数据量

- 单位：B（Byte，1 B = 8 bit）
- 进制：2进制，1 K = $2^{10}$，1 M = $2^{20}$，1 G = $2^{30}$

> 速率

- 单位：bit/s
- 进制：10进制，1 K = $10^3$，1 M = $10^6$， 1G = $10^9$

> 带宽

- 单位：bit/s
- 含义：单位时间内某信道所能通过的最高数据率

> 吞吐量

- 单位：同数据量
- 含义：单位时间内通过某个网络/信道/接口的实际数据量

> 时延

- 单位：s 或 ms

- 构成：

  - 发送时延/传输时延：数据从节点到全部传输到信道上的时间
    $$
    发送时延 = \frac{数据帧长度(bit)}{发送速率(bit/s)}
    $$

  - 传播时延：电磁波在信道中传播一定距离所花费的时间（注意，与数据量无关）。
    $$
    传播时延 = \frac{信道长度(m)}{电磁波在信道上的传播速率(m/s)}
    $$
    常用速率：光纤（$2.0\times 10^8m/s$），铜线（$2.3\times10^8m/x$）

  - 处理时延：主机或路由器分析首部、提取数据、差错检验、查找转发表等所耗费的时间

  - 排队时延：需要处理的分组可能会在路由器中堆积等待处理。若分组过多，导致队列溢出，分组丢失，此时排队时延为无穷大。

- 数据总时延
  $$
  总时延 = 发送时延+传播时延+处理时延+排队时延
  $$

- 注意点：

  - 高速链路/高带宽链路：本质上只是减小了发送时延，与数据传送时间无关，不能说使比特传送更快。
  - 光纤比铜线速率更高：这是光纤信道允许节点用更高的速率将数据发送到信道上，而不是传送速率更快。

> 时延带宽积

- 单位：同数据量
- 含义：一段链路中最多可充满的数据量。将链路视为一段空心管道，则传播时延为它的长度，带宽为它的底面积。

$$
时延带宽积 = 传播时延\times 带宽
$$

> 往返时间 RTT

- 单位：s 或 ms
- 含义：通信双方完成一次双向交互所需的时间，即主机A发出的数据到达信道（开始计时）→主机B发回响应→主机A收到响应（结束计时）

> 利用率

- 信道利用率：某一信道有数据通过的时间占比

- 网络利用率：全网络信道利用率的加权平均值

- **信道利用率或网络利用率过高会产生非常大的时延**（因为网络中大部分时间都有数据，意味着路由器和主机需要一直处理转发分组，这部分速率跟不上会造成分组堆积在各节点中等待处理，导致时延越来越大）
  $$
  D（网络当前时延） = \frac {D_0（网络空闲时延）}{1-U（网络当前利用率）}
  $$

## 1.3 网络体系结构

### 1.3.1 七层体系结构 OSI

### 1.3.2 四层体系结构 TCP/IP

### 1.3.3 五层体系结构（原理）

> 物理层

（1）对象：节点之间

（2）任务：在节点之间透明地传输比特流

（3）负责解决的问题：确定传输媒体接口的特性

- 机械特性：接口所用接线器的形状和尺寸、引线数目和排列、固定和锁定装置等。
- 电气特性：在接口电缆的各条线上出现的电压的范围。
- 功能特性：某条线上出现的某一电平的电压的意义。
- 过程特性：对于不同功能的各种可能事件的出现顺序。

> 数据链路层

（1）对象：两个相邻节点之间

（2）任务：在两个相邻节点之间的链路上传送数据

（3）负责解决的问题：

- 成帧：将网络层交下来的IP数据报组装成帧
- 物理寻址：收发双方的物理地址（同一个网络/本地网络）
- 访问控制：广播信道，如何决定哪台设备可以发送和接收数据
- 差错控制：需要检查所收到的帧是否有差错，并采取响应措施（直接丢弃或通知重传）
- 流量控制：接收方采取措施，使发送方不要过快发送

> 网络层

（1）对象：两个主机之间（可能跨越多个网络）

（2）任务：负责为分组交换网上的不同主机提供通信

（3）负责解决的问题：

- 分组：将运输层的报文段或用户数据报封装成分组或包。
- 逻辑寻址：跨网络通信，需要给主机重新编制逻辑地址。物理寻址是基于同一个网络或本地网络。
- 路由选择：寻找路径能够将分组通过连接设备（路由器）到目的主机。在TCP/IP体系中，网络层(网际层)使用IP协议，IP层分组叫做IP数据报，简称数据报。

> 运输层

（1）对象：两个进程之间

（2）任务：为两个主机中进程之间的通信提供**通用**的数据传输服务

（3）负责解决的问题：

- 服务点寻址：通过端口地址标识特定进程，从而将报文交付对应进程
- 分片与重组：报文可能过长，需要分片交付给下一层；收到的报文是分片的，需要重组成完整报文
- 连接控制、流量控制、差错控制

> 应用层

（1）对象：两个进程之间

（2）任务：负责给用户提供服务（注意运输层只是传输数据，应用层则是规定如何收发、利用数据）。通过应用进程间的交互完成特定网络应用。

（3）负责解决的问题：

- 定义应用进程之间的通信与交互规则